<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.19" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> I Love To Delete Code &middot; I Love To Delete Code </title>

  
  <link rel="stylesheet" href="http://www.ilovetodeletecode.com/css/poole.css">
  <link rel="stylesheet" href="http://www.ilovetodeletecode.com/css/syntax.css">
  <link rel="stylesheet" href="http://www.ilovetodeletecode.com/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.ilovetodeletecode.com/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="http://www.ilovetodeletecode.com/favicon.png">

  
  <link href="http://www.ilovetodeletecode.com/index.xml" rel="alternate" type="application/rss+xml" title="I Love To Delete Code" />
  <style>
      #social,
      #links {
          margin-top: 10px
      }

      #social i {
          margin-left: 25px
      }

      #social a:hover,
      #social a:focus {
          text-decoration: none;
          color: #bddbed
      }

      pre {
        background-color: #202020;
        color: white;
        overflow: auto;
        word-wrap: normal;
        white-space: pre;
        font-size: 12px;
      }



       
  </style>


</head>

<body class="">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="http://www.ilovetodeletecode.com/logo.png" alt="Hugo Themes">
      <a href="http://www.ilovetodeletecode.com/"><h1>I Love To Delete Code</h1></a>
      <p class="lead">
      Deleting code is violating the law of entropy and setting the universe right.
      </p>
    </div>
    <ul class="sidebar-nav">
      <li><a href="http://www.ilovetodeletecode.com/">Home</a> </li>
      
        <li><a href="http://www.ilovetodeletecode.com/post/"> Blog </a></li>
      
        <li><a href="http://www.ilovetodeletecode.com/about/"> About </a></li>
      
    </ul>
    <div id="social" class="text-center">
      <a href="https://twitter.com/JernejGoricki" target="new">
        <i class="fa fa-twitter fa-2x"></i>
      </a>
      <a href="http://uk.linkedin.com/in/jernejgoricki" target="new">
        <i class="fa fa-linkedin fa-2x"></i>
      </a>
</div>
    <p></p>
  </div>
</div>






    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="http://www.ilovetodeletecode.com/post/2014/11/16/fileoptions-enumeration-windows-cache-manager-and-memory-mapped-files-csharp-part-1/">
        FileOptions Enumeration, Windows Cache Manager and Memory-Mapped Files (C#) Part 1
      </a>
    </h1>

    <span class="post-date">Sun, Nov 16, 2014</span>
    <p>Because working with files is such a common and potentially expensive operation, every operating system introduces numerous levels of indirection when serving I/O requests. This is necessary in order to execute I/O operations in a reasonable time frame. But managing complexity through abstraction of various hardware and software layers that interact during file operations also has its disadvantages: you get a false impression that you don&rsquo;t need to know what is really going on under the hood :)</p>

<p>I needed to optimize a part of my code that was writing data to random locations in a binary file. After realizing that <a href="http://msdn.microsoft.com/en-us/library/system.io.fileoptions(v=vs.110).aspx">FileOptions.RandomAccess</a> does not automagically do the trick and make seeks (in a loop!) run noticeably faster, I started to dig into the FileOptions Enumeration. A couple of days later, bursting with knowledge on internal working of Windows Cache Manager and speeding up random writes using <a href="http://msdn.microsoft.com/en-us/library/dd997372%28v=vs.110%29.aspx">Memory-Mapped Files</a> I decided to write a two part blog post about it.</p>

<p></p>
    <a href="http://www.ilovetodeletecode.com/post/2014/11/16/fileoptions-enumeration-windows-cache-manager-and-memory-mapped-files-csharp-part-1/" style="margin-right:0.3rem;float:right;">Read More…</a>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://www.ilovetodeletecode.com/post/2014/05/19/keep-your-mercurial-revision-history-clutter-free/">
        Keep your Mercurial revision history clutter free
      </a>
    </h1>

    <span class="post-date">Mon, May 19, 2014</span>
    <p>I have been using Mercurial revision control system as a weapon of choice for quite some time now. For controlling changes made to source code, as for backing up to a private repository hosted at Bitbucket I used the basic commands for committing, adding, pushing and pulling files to/from the local /remote repository on a daily basis. And that was sufficient for my needs&hellip;.until recently. I stumbled upon an interesting blog post titled <a href="http://elegantcode.com/2014/02/15/segregate-your-code-commits-into-tiny-topical-changes/comment-page-1/">&ldquo;Segregate your commits into tiny topical changes&rdquo;</a> that made me think of how my current revision history on a project looks like&hellip;</p>

<p></p>
    <a href="http://www.ilovetodeletecode.com/post/2014/05/19/keep-your-mercurial-revision-history-clutter-free/" style="margin-right:0.3rem;float:right;">Read More…</a>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://www.ilovetodeletecode.com/post/2014/02/05/refactoring-a-spaghetti-c-serial-communication-app-asynchronous-control-flow-modeling-with-asyncawait/">
        Refactoring a spaghetti C# serial communication app &amp; asynchronous control flow modeling with async/await
      </a>
    </h1>

    <span class="post-date">Wed, Feb 5, 2014</span>
    <p>A couple of months back I&rsquo;ve got a task of implementing a protocol for an embedded device sending/receiving streams of data through serial communication. Together with this task I also inherited a Windows Forms C# application that already did some of the previous but in a different protocol with a different device. The more I struggled to understand and reuse some of the existing infrastructure, the more I wanted to rewrite the whole thing (sounds familiar?).</p>

<p>Some facts about existing code:</p>

<ul>
<li>Each scenario was implemented as a complex state machine with long switch statements.</li>
<li>For each scenario a heavy weight enum with all possible states was defined.</li>
<li>State machine transitions were implemented with a table of Action delegates paired with already mentioned enumerations in a key/value dictionary.</li>
<li>Events were used to signal status of long running operations.</li>
</ul>

<p>Such code was really hard to read and even harder to maintain. And if you don’t have the documentation for the device&rsquo;s programming interface it&rsquo;s all even harder.</p>

<p>In this post I&rsquo;m trying to solve two things:</p>

<ol>
<li>How to design a more robust flexible issue/response system used for communicating with the serial device.</li>
<li>How to model complex asynchronous control flows, without blocking, using Task Parallel Library and C# 5.0 async/await.</li>
</ol>

<p></p>
    <a href="http://www.ilovetodeletecode.com/post/2014/02/05/refactoring-a-spaghetti-c-serial-communication-app-asynchronous-control-flow-modeling-with-asyncawait/" style="margin-right:0.3rem;float:right;">Read More…</a>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://www.ilovetodeletecode.com/post/2013/10/31/prevent-large-file-commits-with-powershell-and-mercurial-hooks/">
        Prevent large file commits with PowerShell and Mercurial hooks
      </a>
    </h1>

    <span class="post-date">Thu, Oct 31, 2013</span>
    <p>Because of Mercurial&rsquo;s immutable historical record of project files there is no way to make a committed file completely disappear from the history tree. Our only hope in this case it&rsquo;s not Obi-Wan but the hg rollback command if we act quickly. Since this command only works for one most recent operation <a href="http://stackoverflow.com/questions/3288865/how-to-keep-a-mercurial-repository-small/">(How to keep a Mercurial repository small?)</a> it will not work if we already committed one or more changes after the change that we would like to completely remove <a href="http://stackoverflow.com/questions/8466669/accidentally-committed-a-large-amount-of-raw-data-in-mercurial-how-do-i-keep-it">(Accidentally committed a large amount of raw data in Mercurial, how do I keep it from overloading my Bitbucket repository?)</a>. Our problems escalate even faster if we already pushed or pulled changes to a remote repository and our bad commit propagated to other collaborators.</p>

<p>Two most common cases of brown paper bag commits <a href="http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html#sec:undo:aaaiiieee">(a commit that is so bad you want to pull a brown paper bag over your head)</a> are accidentally committing sensitive information files (passwords, connection strings&hellip;) and large files. The latter case is less critical because it only increase s repository size and the time it takes to perform operations like pull or clone.</p>

<p>If you are interested in how to prevent yourself from committing large files and are more comfortable with PowerShell then please read on. If you are more of an indentation than squirrely brackets guy then you can check this similar solution in Python - <a href="http://stackoverflow.com/questions/2551719/mercurial-hook-to-disallow-committing-large-binary-files">Mercurial hook to disallow committing large binary files</a>.</p>

<p></p>
    <a href="http://www.ilovetodeletecode.com/post/2013/10/31/prevent-large-file-commits-with-powershell-and-mercurial-hooks/" style="margin-right:0.3rem;float:right;">Read More…</a>
  </div>
  
  
    
</div>
</div>
  </body>
</html>


